/* ************************************************************************** */
/*                                                                            */
/*                                                        ::::::::            */
/*   init.js                                            :+:    :+:            */
/*                                                     +:+                    */
/*   By: fbes <fbes@student.codam.nl>                 +#+                     */
/*                                                   +#+                      */
/*   Created: 2022/03/27 03:00:23 by fbes          #+#    #+#                 */
/*   Updated: 2022/03/28 18:44:22 by fbes          ########   odam.nl         */
/*                                                                            */
/* ************************************************************************** */

// this script initializes all global functions and variables for use elsewhere
// in this extension's content scripts

// inject script to apply framework functions to elements generated by Improved Intra
// only inject it on the subdomains of *.intra.42.fr
if (window.location.origin.indexOf(".intra.42.fr") > -1) {
    const s = document.createElement('script');
    s.src = chrome.runtime.getURL('generic/inject.js');
    (document.head || document.documentElement).appendChild(s);
}

// global variables
const improvedStorage = getSessionStorage();
const networkHandler = normalNetworkHandler; // no incognito network handler neccessary in the foreground scripts
const portName = (chrome.extension.inIncognitoContext ? "incog_comm" : "normal_comm");

function test() {
    networkHandler.get("https://feedback.free.beeceptor.com/todos").then(response => {
        if (response.status == 200) {
            response.json().then(response => {
                console.log(response)
            });
        }
    });
}

test()

// improvedStorage.set({ "iintra-server-session": true });
// const today = new Date();
// const dayOfWeek = (today.getDay() > 0 ? today.getDay() - 1 : 6); // fix monday = 0 & sunday = 6
// const dayOfMonth = today.getDate();
